<?php 
session_start();

require_once 'classes/database.php';
require_once 'classes/users.php';
require_once 'classes/projects.php';
require_once 'classes/titles.php';
require_once 'classes/stations.php';
require_once 'classes/products.php';
require_once 'classes/logging.php';
require_once 'classes/general.php';
require_once 'classes/bcrypt.php';

// error_reporting(0);

$log = new Logging();
$log->lfile($_SERVER['DOCUMENT_ROOT'] . '/app/log/mylog.txt'); // na serwerze

$date = new DateTime();
$date->add(new DateInterval('P30D'));

$db       = Database::connect();
$users 		= new Users($db, $log);
$general 	= new General();
$bcrypt 	= new Bcrypt(12);
$projects 	= new Projects($db, $log, date_format($date,'Y-m-d'));
$titles   	= new Titles($db);
$stations	= new Stations($db);
$products	= new Products($db, $log);

$errors = array();

if ($general->logged_in() === true)  {
	$user_id 	= $_SESSION['id'];
	$user 		= $users->userdata($user_id);
	$host	 	= isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] == 'on' ? 'https://' : 'http://' . $_SERVER['HTTP_HOST'].'/';
	//$log->lwrite('Login: ' . $user['username'] . ' (' . $user_id . ')' . ' [' . $host . ']');
}

ob_start(); // Added to avoid a common error of 'header already sent'